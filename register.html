document.addEventListener('DOMContentLoaded', () => {
  let currentLang = 'es';

  function applyTranslations() {
    document.querySelectorAll('[data-es]').forEach(el => {
      const esText = el.getAttribute('data-es');
      const enText = el.getAttribute('data-en');
      if (currentLang === 'es') {
        if (el.placeholder !== undefined && el.tagName === 'INPUT') {
          el.placeholder = esText;
        } else if (el.tagName === 'OPTION') {
          el.textContent = esText;
        } else {
          el.textContent = esText;
        }
      } else {
        if (el.placeholder !== undefined && el.tagName === 'INPUT') {
          el.placeholder = enText;
        } else if (el.tagName === 'OPTION') {
          el.textContent = enText;
        } else {
          el.textContent = enText;
        }
      }
    });
  }

  document.getElementById('langES').addEventListener('click', () => {
    currentLang = 'es';
    applyTranslations();
  });
  document.getElementById('langEN').addEventListener('click', () => {
    currentLang = 'en';
    applyTranslations();
  });

  // Detect location and fill fields
  document.getElementById('detectLocation').addEventListener('click', () => {
    if (!navigator.geolocation) {
      alert(currentLang === 'es' ? 'La geolocalizaciÃ³n no es compatible.' : 'Geolocation is not supported.');
      return;
    }
    navigator.geolocation.getCurrentPosition(
      pos => {
        const { latitude, longitude } = pos.coords;
        document.getElementById('latitude').value = latitude.toFixed(6);
        document.getElementById('longitude').value = longitude.toFixed(6);
      },
      err => {
        alert('Error: ' + err.message);
      }
    );
  });

  applyTranslations();
});
